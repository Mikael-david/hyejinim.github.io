<!DOCTYPE html>
<html>

<head>
  <title>Lab1: Emoji Zoo by Hyejin Im</title>
  <script type = "text/javascript">
    // Global variables
    var animals = [];
    var selected = null;

    window.onload = function() { // Main() function
      // Set up canvas
      var c = document.getElementById("MyCanvas");
      var gc = c.getContext("2d");
      c.width = window.innerWidth-15;
      c.height = window.innerHeight-180;

      // Draw background
      drawBackground();

      // Draw animals and put them in an array list
      var chk = new BabyChick("BabyChick");
      chk.draw(gc);
      animals.push(chk);

      var mk = new Monkey("Monkey");
      mk.draw(gc);
      animals.push(mk);

      var tt = new Turtle("Turtle");
      tt.draw(gc);
      animals.push(tt);

      var dog = new Dog("Dog");
      dog.draw(gc);
      animals.push(dog);

      var pig = new Pig("Pig");
      pig.draw(gc);
      animals.push(pig);

      var elpt = new Elephant("Elephant");
      elpt.draw(gc);
      animals.push(elpt);

      var owl = new Owl("owl");
      owl.draw(gc);
      animals.push(owl);

      // Make buttons
      new MoveButton("Left ⬅ ");
      new MoveButton("Down ⬇");
      new MoveButton("Up ⬆");
      new MoveButton("Right ➡");
    }

    class Animal {
      constructor() {
        this.emoji = "?";
        this.x = 0;
        this.y = 0;
        this.size = 30;
        this.speed = this.size/3;
      }

      draw(context) {
        // document.getElementById("statusmsg").innerHTML =
        // this.label + " was created at " + event.clientX + ", " + event.clientY;
        context.font = (this.size)+"px Helvetica";
        context.fillText(this.emoji, this.x - (this.size/2), this.y + (this.size/2));

        // // Test for calibrating position created
        // var c = document.getElementById("MyCanvas");
        // var gc = c.getContext("2d");
        //
        // gc.strokeStyle = "#000000";
        // gc.beginPath();
        // gc.moveTo(this.x, this.y);
        // gc.lineTo(this.x+10, this.y);
        // gc.moveTo(this.x, this.y);
        // gc.lineTo(this.x, this.y-10);
        // gc.stroke();
        //
        // gc.fillStyle = "#FF0000";
        // gc.beginPath(); // when path starts
        // gc.arc(this.x + (this.size/2), this.y - (this.size/2), 3, 0, 2.*Math.PI)
        // gc.fill();
      }

      setPosition(x, y){
        this.x = x;
        this.y = y;
      }

      // move(x, y) {
      //   var c = document.getElementById("MyCanvas");
      //   var gc = c.getContext("2d");
      //   var i;
      //
      //   this.x = x;
      //   this.y = y;
      //
      //   drawBackground(gc);
      //
      //   for (i = 0; i < animals.length; i++) {
      //   animals[i].draw(gc);
      //   }
      // }
    }

    class BabyChick extends Animal {
      constructor() {
        var c = document.getElementById("MyCanvas");

        super();
        this.emoji = "🐥";
        this.size = 1.5 * this.size;
        this.x = this.size + Math.random()*(c.width-this.size);
        this.y = this.size + Math.random()*(c.height-this.size);
      }
    }

    class Monkey extends Animal {
      constructor() {
        var c = document.getElementById("MyCanvas");

        super();
        this.emoji = "🐒";
        this.size = 2 * this.size;
        this.x = Math.random()*c.width;
        this.y = Math.random()*c.height;
      }
    }

    class Turtle extends Animal {
      constructor() {
        var c = document.getElementById("MyCanvas");

        super();
        this.emoji = "🐢";
        this.size = 2 * this.size;
        this.x = Math.random()*c.width;
        this.y = Math.random()*c.height;
      }
    }

    class Dog extends Animal {
      constructor() {
        var c = document.getElementById("MyCanvas");

        super();
        this.emoji = "🐕";
        this.size = 2.5 * this.size;
        this.x = Math.random()*c.width;
        this.y = Math.random()*c.height;
      }
    }

    class Pig extends Animal {
      constructor() {
        var c = document.getElementById("MyCanvas");

        super();
        this.emoji = "🐖";
        this.size = 4 * this.size;
        this.x = Math.random()*c.width;
        this.y = Math.random()*c.height;

      }
    }

    class Elephant extends Animal {
      constructor() {
        var c = document.getElementById("MyCanvas");

        super();
        this.emoji = "🐘 ";
        this.size = 5.5 * this.size;
        this.x =  Math.random()*(c.width-this.size);
        this.y =  Math.random()*(c.height-this.size) + this.size;
      }
    }

    class Owl extends Animal {
      constructor() {
        var c = document.getElementById("MyCanvas");

        super();
        this.emoji = "🦉";
        this.size = 2 * this.size;
        this.x = Math.random()*c.width;
        this.y = Math.random()*c.height;
      }
    }

    class MoveButton {
      constructor(label) {
        this.button = document.createElement("input");
        this.button.setAttribute("type", "button");
        this.button.setAttribute("value", label);
        document.getElementById("buttonarea").appendChild(this.button);

        var self = this;
        this.button.onclick = function() {
          self.callback();
        }
      }

      callback() {
        document.getElementById("statusmsg").innerHTML =
          "'" + this.button.value + "'" + " button" + " was pushed ";
        var label = this.button.value;
        if (label == "Left ⬅ ") {
          selected.setPosition(selected.x - selected.speed, selected.y);
          console.log(selected.emoji + " was moved to " + label);
        }
        else if (label == "Right ➡") {
          selected.setPosition(selected.x + selected.speed, selected.y);
        }
        else if (label == "Down ⬇") {
          selected.setPosition(selected.x, selected.y + selected.speed);
        }
        else if (label == "Up ⬆") {
          selected.setPosition(selected.x, selected.y - selected.speed);
        }
        drawBackground();
        drawAnimals();

      }
    }

    function drawBackground() {
      var c = document.getElementById("MyCanvas");
      var gc = c.getContext("2d");

      // Grey background
      gc.fillStyle = "#EEEEEE";
      gc.fillRect(0, 0, c.width, c.height);
    }

    function drawAnimals(){
      var c = document.getElementById("MyCanvas");
      var gc = c.getContext("2d");
      var i;

      for (i = 0; i < animals.length; i++) {
      animals[i].draw(gc);
      }
    }

    function select(x, y){
      // test
      // console.log("selected: " + selected);
      // console.log("animals.length: " + animals.length);
      // console.log(animals[0], animals[0].x, animals[0].y);

      var c = document.getElementById("MyCanvas");
      var gc = c.getContext("2d");
      var rect = c.getBoundingClientRect();

      // var animalX = animals[i].x - rect.left;
      // var animalY = animals[i].y - rect.top;
      var i;
      for (i = 0; i < animals.length; i++) {
        var boundX = animals[i].x - (animals[i].size/2);
        var boundY = animals[i].y - (animals[i].size/2);

        if (boundX <= x+rect.left &&  x+rect.left <= (boundX + animals[i].size) &&
        boundY <= y-rect.top && y-rect.top <= (boundY + animals[i].size)) {

          selected = animals[i];
          console.log("Mouse down at " + x + ", " + y + " and " + animals[i].emoji + " was selected");

          // test
          // console.log("animals["+ i + "]: " + animals[i].emoji);

          gc.strokeStyle = "#000000";
          gc.strokeRect(boundX, boundY, animals[i].size, animals[i].size);

          break;
        }
      }
    }

    function handleClick(event){
      var chk = new BabyChick("BabyChick");
      var c = document.getElementById("MyCanvas");
      var gc = c.getContext("2d");
      var rect = c.getBoundingClientRect();

      chk.setPosition(event.clientX - rect.left, event.clientY - rect.top);
      // test
      // console.log("event.clientX: " + event.clientX + "event.clientY: " + event.clientY);
      chk.draw(gc);
    }

  </script>

</head>

<body>
  <div id="title">
    <h1>Emoji Zoo</h1>
  </div>
  <!-- handleClick(event),  -->
  <canvas id="MyCanvas" width=700 height=500 onclick="select(event.clientX, event.clientY)"></canvas>
  <div id="buttonarea">
    &nbsp;
  </div>
  <p><span id = "statusmsg">(Nothing Here)</span></p>

</body>

</html>
